<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<org.eventb.core.machineFile org.eventb.core.comment="This machine models the access level of Service Providers to My Health Record.&#10;   There are three levels of access and they will play a more important role&#10;   when the level of record access is introduced (in later refinements). The level&#10;   of access are&#10;   General Access: Service provider can access and upload records&#10;   Restricted Access: Service provider can access and upload records&#10;   Revoked Access: Service providers have been revoked. They cannot access or upload records.&#10;   The difference between General and Restricted will be more notorious in coming&#10;   refinements. " org.eventb.core.configuration="org.eventb.core.fwd" org.eventb.core.generated="false" org.eventb.texttools.text_lastmodified="1583914579912" org.eventb.texttools.text_representation="machine ref3_level_access_sp&#10;/* This machine models the access level of Service Providers to My Health Record.&#10;   There are three levels of access and they will play a more important role&#10;   when the level of record access is introduced (in later refinements). The level&#10;   of access are&#10;   General Access: Service provider can access and upload records&#10;   Restricted Access: Service provider can access and upload records&#10;   Revoked Access: Service providers have been revoked. They cannot access or upload records.&#10;   The difference between General and Restricted will be more notorious in coming&#10;   refinements. */&#10; refines ref2_service_providers  sees ctx_ref2&#10;&#10;variables&#10;&#9;&#9;my_health_report_DB consumer&#10;&#9;&#9;my_MHR // REFINEMENT 1&#10;        records // the set of records in the system&#10;        records_mhr // maps a record to the My Health Report it belongs to&#10;        consumer_own_records // maps a consumer to their records&#10;&#9;&#9;//REFINEMENT 2&#10;&#9;&#9;service_providers // set of registered service providers&#10;&#9;&#9;consumer_sp // maps consumers to Service Providers&#10;&#9;&#9;access_sp_mhr // models the access of Service Providers to My Health Records&#10;&#9;&#9;staff // list of staff (e.g. doctors, nurses)&#10;        staff_sp // maps staff to the Service Providers they work on&#10;        // REFINEMENT 3&#10;        general_access_list_sp // maps Health Service Providers with 'General Access' to My Health Record&#10;        restricted_access_list_sp // maps Health Service Providers with 'Restricted Access' to My Health Record&#10;        revoked_list_sp // maps Health Service Providers whose access have been revoked to My Health Record&#10;&#10;&#10;invariants&#10;  @inv1_r3 general_access_list_sp ∈ service_providers ↔  my_health_report_DB&#10;  @inv2_r3 restricted_access_list_sp ∈ service_providers ↔  my_health_report_DB&#10;  @inv3_r3 revoked_list_sp ∈ service_providers ↔  my_health_report_DB&#10;  @inv5_r3 partition(access_sp_mhr, general_access_list_sp, restricted_access_list_sp, revoked_list_sp) // each Health Service Provider has only one access level to a My Health Record&#10;&#10;events&#10;  event INITIALISATION extends INITIALISATION&#10;    then&#10;      @act1_r3 general_access_list_sp ≔ ∅&#10;      @act2_r3 restricted_access_list_sp ≔ ∅&#10;      @act3_r3 revoked_list_sp ≔  ∅&#10;  end&#10;&#10;  event opt_in&#10;  /* Any person can opt in the system. When this happens, a new My Health Record is&#10;     set, initially empty. The new consumer can populate the Record with the last&#10;     2 year of activities. This part is not modelled as it does not concer the&#10;     access of privacy&#10;      */&#10;  extends opt_in&#10;  end&#10;&#10;  event opt_out&#10;  /* A user of the system can decide, at any time, to opt-out the system.&#10;     If this happens, all records their My Health Report are deleted (permanently),&#10;     the My Health Recodr and the user are deleted from the system.&#10;      */&#10;  extends opt_out&#10;  then&#10;  &#9;@act1_r3 general_access_list_sp ≔ general_access_list_sp⩥{my_MHR(c)}&#10;    @act2_r3 restricted_access_list_sp ≔ restricted_access_list_sp⩥{my_MHR(c)}&#10;    @act3_r3 revoked_list_sp ≔  revoked_list_sp⩥{my_MHR(c)}&#10;  end&#10;&#10;  event view_record_owner&#10;  /* Access a specific record 'r' by 'c' to view it.&#10;     This is an action over the record&#10;      */&#10;  extends view_record_owner&#10;  end&#10;&#10;  event delete_record&#10;  /* It deletes an existing record (only if it is the owner)&#10;     This is an action over the My Health Report system&#10;      */&#10;  extends delete_record&#10;  end&#10;&#10;  event upload_record_owner&#10;  /* It uploads a new record. It belongs to 'ow'&#10;     This is an action over the My Health Report system.&#10;      */&#10;  extends upload_record_owner&#10;  end&#10;&#10;  event upload_record_staff&#10;  /* models a staff uploading a new record. It belongs to 'ow'&#10;     This is an action over the My Health Report system.&#10;      */&#10;  extends upload_record_staff&#10;  where&#10;  &#9;@grd1_r3 sp↦my_MHR(ow) ∉  revoked_list_sp&#10;  end&#10;&#10;  event add_consumer_sp&#10;  /* Adds a consumer to a Service Provider.&#10;     This is an action of the System&#10;      */&#10;  extends add_consumer_sp&#10;  then&#10;  &#9;@act1_r3 general_access_list_sp ≔ general_access_list_sp ∪ {sp↦my_MHR(c)}&#10;  end&#10;&#10;  event view_record_staff&#10;  /* Access to a specific record 'r' by a staff.&#10;      */&#10;  extends view_record_staff&#10;  where&#10;  &#9;@grd1_r3 sp↦records_mhr(r) ∉  revoked_list_sp&#10;  end&#10;&#10;  event add_staff_sp&#10;  /* This event add a staff to a Service Provider&#10;      */&#10;  extends add_staff_sp&#10;  end&#10;&#10;  event add_sp&#10;  /* Adds a new Service Provider to the system&#10;      */&#10;  extends add_sp&#10;  end&#10;&#10;  event revoke_access_sp&#10;  /*&#10;  &#9;revoke access to a Service Provider&#10;&#10;  &#9;TODO: enforce&#10;  */&#10;  any sp &#9;// Service Provider&#10;  &#9;mhr&#9;&#9;// My Health Record&#10;  &#9;c&#9;&#9;// Consumer&#10;  where&#10;  &#9;@grd4_r3 sp ∈ service_providers&#10;  &#9;@grd5_r3 mhr ∈ my_health_report_DB&#10;  &#9;@grd6_r3 c ∈ consumer&#10;  &#9;@grd1_r3 c↦mhr ∈ my_MHR&#10;  &#9;@grd2_r3 c↦sp ∈   consumer_sp&#10;  &#9;@grd3_r3 sp↦my_MHR(c) ∉ revoked_list_sp&#10;  &#9;@grd7_r3 sp↦my_MHR(c) ∈ restricted_access_list_sp ∨ sp↦my_MHR(c) ∈ general_access_list_sp&#10;  then&#10;  &#9;@act1_r3 revoked_list_sp ≔ revoked_list_sp ∪ {sp↦my_MHR(c)}&#10;  &#9;@act2_r3 restricted_access_list_sp ≔ restricted_access_list_sp ∖ {sp↦my_MHR(c)}&#10;  &#9;@act3_r3 general_access_list_sp ≔ general_access_list_sp ∖ {sp↦my_MHR(c)}&#10;  end&#10;&#10;  event give_restricted_access_sp&#10;  /*&#10;  &#9;Gives restricted access to a Service Provider&#10;&#10;  &#9;TODO: enforce&#10;  */&#10;  any sp &#9;// Service Provider&#10;  &#9;mhr&#9;&#9;// My Health Record&#10;  &#9;c&#9;&#9;// Consumer&#10;  where&#10;  &#9;@grd4_r3 sp ∈ service_providers&#10;  &#9;@grd5_r3 mhr ∈ my_health_report_DB&#10;  &#9;@grd6_r3 c ∈ consumer&#10;  &#9;@grd1_r3 c↦mhr ∈ my_MHR&#10;  &#9;@grd2_r3 c↦sp ∈ consumer_sp&#10;  &#9;@grd3_r3 sp↦my_MHR(c) ∈ revoked_list_sp ∨ sp↦my_MHR(c) ∈ general_access_list_sp&#10;  &#9;@grd7_r3 sp↦my_MHR(c) ∉ restricted_access_list_sp&#10;  then&#10;  &#9;@act1_r3 revoked_list_sp ≔ revoked_list_sp ∖ {sp↦my_MHR(c)}&#10;  &#9;@act2_r3 restricted_access_list_sp ≔ restricted_access_list_sp ∪ {sp↦my_MHR(c)}&#10;  &#9;@act3_r3 general_access_list_sp ≔ general_access_list_sp ∖ {sp↦my_MHR(c)}&#10;  end&#10;&#10;  event give_general_access_sp&#10;  /*&#10;  &#9;Gives general access to a Service Provider&#10;&#10;  &#9;TODO: enforce&#10;  */&#10;  any sp &#9;// Service Provider&#10;  &#9;mhr&#9;&#9;// My Health Record&#10;  &#9;c&#9;&#9;// Consumer&#10;  where&#10;  &#9;@grd4_r3 sp ∈ service_providers&#10;  &#9;@grd5_r3 mhr ∈ my_health_report_DB&#10;  &#9;@grd6_r3 c ∈ consumer&#10;  &#9;@grd1_r3 c↦mhr ∈ my_MHR&#10;  &#9;@grd2_r3 c↦sp ∈   consumer_sp&#10;  &#9;@grd3_r3 sp↦my_MHR(c) ∈ revoked_list_sp ∨ sp↦my_MHR(c) ∈ restricted_access_list_sp&#10;  &#9;@grd7_r3 sp↦my_MHR(c) ∉ general_access_list_sp&#10;  then&#10;  &#9;@act1_r3 revoked_list_sp ≔ revoked_list_sp ∖ {sp↦my_MHR(c)}&#10;  &#9;@act2_r3 restricted_access_list_sp ≔ restricted_access_list_sp ∖ {sp↦my_MHR(c)}&#10;  &#9;@act3_r3 general_access_list_sp ≔ general_access_list_sp ∪ {sp↦my_MHR(c)}&#10;  end&#10;end&#10;" version="5">
<org.eventb.core.refinesMachine name="_DMDXAGNmEeqfwL_WG7Gltw" org.eventb.core.target="ref2_service_providers"/>
<org.eventb.core.seesContext name="_2Hi1YGAkEeqDMsFs4V7FUQ" org.eventb.core.target="ctx_ref2"/>
<org.eventb.core.variable name="_IqG0s19AEeqDMsFs4V7FUQ" org.eventb.core.generated="false" org.eventb.core.identifier="my_health_report_DB"/>
<org.eventb.core.variable name="_IqG0tF9AEeqDMsFs4V7FUQ" org.eventb.core.generated="false" org.eventb.core.identifier="consumer"/>
<org.eventb.core.variable name="_GOfb8F9CEeqDMsFs4V7FUQ" org.eventb.core.comment="REFINEMENT 1" org.eventb.core.generated="false" org.eventb.core.identifier="my_MHR"/>
<org.eventb.core.variable name="_ai0bUF9DEeqDMsFs4V7FUQ" org.eventb.core.comment="the set of records in the system" org.eventb.core.generated="false" org.eventb.core.identifier="records"/>
<org.eventb.core.variable name="_ai0bUV9DEeqDMsFs4V7FUQ" org.eventb.core.comment="maps a record to the My Health Report it belongs to" org.eventb.core.generated="false" org.eventb.core.identifier="records_mhr"/>
<org.eventb.core.variable name="_f3GGcF9FEeqDMsFs4V7FUQ" org.eventb.core.comment="maps a consumer to their records&#10;REFINEMENT 2" org.eventb.core.generated="false" org.eventb.core.identifier="consumer_own_records"/>
<org.eventb.core.variable name="_cSVVcGAlEeqDMsFs4V7FUQ" org.eventb.core.comment="set of registered service providers" org.eventb.core.generated="false" org.eventb.core.identifier="service_providers"/>
<org.eventb.core.variable name="_cSVVcWAlEeqDMsFs4V7FUQ" org.eventb.core.comment="maps consumers to Service Providers" org.eventb.core.generated="false" org.eventb.core.identifier="consumer_sp"/>
<org.eventb.core.variable name="_qLJhkGA0EeqDMsFs4V7FUQ" org.eventb.core.comment="models the access of Service Providers to My Health Records" org.eventb.core.generated="false" org.eventb.core.identifier="access_sp_mhr"/>
<org.eventb.core.variable name="_vpLwMGA3EeqDMsFs4V7FUQ" org.eventb.core.comment="list of staff (e.g. doctors, nurses)" org.eventb.core.generated="false" org.eventb.core.identifier="staff"/>
<org.eventb.core.variable name="_NNjusGKWEeqDMsFs4V7FUQ" org.eventb.core.comment="maps staff to the Service Providers they work on&#10;REFINEMENT 3" org.eventb.core.generated="false" org.eventb.core.identifier="staff_sp"/>
<org.eventb.core.event name="_vpLwMGA3EeqDMsFs4V7FUR" org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="INITIALISATION">
<org.eventb.core.action name="_tN7A4GNnEeqfwL_WG7Gltw" org.eventb.core.assignment="general_access_list_sp ≔ ∅" org.eventb.core.generated="false" org.eventb.core.label="act1_r3"/>
<org.eventb.core.action name="_UW-1IGNqEeqfwL_WG7Gltw" org.eventb.core.assignment="restricted_access_list_sp ≔ ∅" org.eventb.core.generated="false" org.eventb.core.label="act2_r3"/>
<org.eventb.core.action name="_UW-1IWNqEeqfwL_WG7Gltw" org.eventb.core.assignment="revoked_list_sp ≔  ∅" org.eventb.core.generated="false" org.eventb.core.label="act3_r3"/>
</org.eventb.core.event>
<org.eventb.core.event name="_vpLwMGA3EeqDMsFs4V7FUS" org.eventb.core.comment="Any person can opt in the system. When this happens, a new My Health Record is&#10;     set, initially empty. The new consumer can populate the Record with the last&#10;     2 year of activities. This part is not modelled as it does not concer the&#10;     access of privacy&#10;      " org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="opt_in">
<org.eventb.core.refinesEvent name="'" org.eventb.core.target="opt_in"/>
</org.eventb.core.event>
<org.eventb.core.event name="_vpLwMGA3EeqDMsFs4V7FUT" org.eventb.core.comment="A user of the system can decide, at any time, to opt-out the system.&#10;     If this happens, all records their My Health Report are deleted (permanently),&#10;     the My Health Recodr and the user are deleted from the system.&#10;      " org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="opt_out">
<org.eventb.core.refinesEvent name="'" org.eventb.core.target="opt_out"/>
<org.eventb.core.action name="_eT7RUGNoEeqfwL_WG7Gltw" org.eventb.core.assignment="general_access_list_sp ≔ general_access_list_sp⩥{my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act1_r3"/>
<org.eventb.core.action name="_wSVswGNqEeqfwL_WG7Gltw" org.eventb.core.assignment="restricted_access_list_sp ≔ restricted_access_list_sp⩥{my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act2_r3"/>
<org.eventb.core.action name="_wSVswWNqEeqfwL_WG7Gltw" org.eventb.core.assignment="revoked_list_sp ≔  revoked_list_sp⩥{my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act3_r3"/>
</org.eventb.core.event>
<org.eventb.core.event name="_vpLwMGA3EeqDMsFs4V7FUU" org.eventb.core.comment="Access a specific record 'r' by 'c' to view it.&#10;     This is an action over the record&#10;      " org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="view_record_owner">
<org.eventb.core.refinesEvent name="'" org.eventb.core.target="view_record_owner"/>
</org.eventb.core.event>
<org.eventb.core.event name="_vpLwMGA3EeqDMsFs4V7FUV" org.eventb.core.comment="It deletes an existing record (only if it is the owner)&#10;     This is an action over the My Health Report system&#10;      " org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="delete_record">
<org.eventb.core.refinesEvent name="'" org.eventb.core.target="delete_record"/>
</org.eventb.core.event>
<org.eventb.core.event name="_vpLwMGA3EeqDMsFs4V7FUW" org.eventb.core.comment="It uploads a new record. It belongs to 'ow'&#10;     This is an action over the My Health Report system.&#10;      " org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="upload_record_owner">
<org.eventb.core.refinesEvent name="'" org.eventb.core.target="upload_record_owner"/>
</org.eventb.core.event>
<org.eventb.core.event name="_bwwz0GMiEeqDMsFs4V7FUQ" org.eventb.core.comment="models a staff uploading a new record. It belongs to 'ow'&#10;     This is an action over the My Health Report system.&#10;      " org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="upload_record_staff">
<org.eventb.core.refinesEvent name="_bwwz0WMiEeqDMsFs4V7FUQ" org.eventb.core.target="upload_record_staff"/>
<org.eventb.core.guard name="_-j2AUGNmEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd1_r3" org.eventb.core.predicate="sp↦my_MHR(ow) ∉  revoked_list_sp"/>
</org.eventb.core.event>
<org.eventb.core.event name="_vpLwMGA3EeqDMsFs4V7FUX" org.eventb.core.comment="Adds a consumer to a Service Provider.&#10;     This is an action of the System&#10;      " org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="add_consumer_sp">
<org.eventb.core.refinesEvent name="'" org.eventb.core.target="add_consumer_sp"/>
<org.eventb.core.action name="_S6aJdmNqEeqfwL_WG7Gltw" org.eventb.core.assignment="general_access_list_sp ≔ general_access_list_sp ∪ {sp↦my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act1_r3"/>
</org.eventb.core.event>
<org.eventb.core.event name="_vpLwMGA3EeqDMsFs4V7FUY" org.eventb.core.comment="Access to a specific record 'r' by a staff.&#10;      " org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="view_record_staff">
<org.eventb.core.refinesEvent name="'" org.eventb.core.target="view_record_staff"/>
<org.eventb.core.guard name="_QTTEoGNnEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd1_r3" org.eventb.core.predicate="sp↦records_mhr(r) ∉  revoked_list_sp"/>
</org.eventb.core.event>
<org.eventb.core.event name="_vpLwMGA3EeqDMsFs4V7FUZ" org.eventb.core.comment="This event add a staff to a Service Provider&#10;      " org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="add_staff_sp">
<org.eventb.core.refinesEvent name="'" org.eventb.core.target="add_staff_sp"/>
</org.eventb.core.event>
<org.eventb.core.event name="_vpLwMGA3EeqDMsFs4V7FU[" org.eventb.core.comment="Adds a new Service Provider to the system&#10;      " org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="add_sp">
<org.eventb.core.refinesEvent name="'" org.eventb.core.target="add_sp"/>
</org.eventb.core.event>
<org.eventb.core.variable name="_itFtwGMXEeqDMsFs4V7FUQ" org.eventb.core.comment="maps Health Service Providers with 'General Access' to My Health Record" org.eventb.core.generated="false" org.eventb.core.identifier="general_access_list_sp"/>
<org.eventb.core.variable name="_itFtwWMXEeqDMsFs4V7FUQ" org.eventb.core.comment="maps Health Service Providers with 'Restricted Access' to My Health Record" org.eventb.core.generated="false" org.eventb.core.identifier="restricted_access_list_sp"/>
<org.eventb.core.variable name="_itFtwmMXEeqDMsFs4V7FUQ" org.eventb.core.comment="maps Health Service Providers whose access have been revoked to My Health Record" org.eventb.core.generated="false" org.eventb.core.identifier="revoked_list_sp"/>
<org.eventb.core.event name="_W7y7QGNqEeqfwL_WG7Gltw" org.eventb.core.comment="&#10;  &#9;revoke access to a Service Provider&#10;&#10;  &#9;TODO: enforce&#10;  " org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="revoke_access_sp">
<org.eventb.core.parameter name="_S6aJcWNqEeqfwL_WG7Gltw" org.eventb.core.comment="Service Provider" org.eventb.core.generated="false" org.eventb.core.identifier="sp"/>
<org.eventb.core.parameter name="_S6aJcmNqEeqfwL_WG7Gltw" org.eventb.core.comment="My Health Record" org.eventb.core.generated="false" org.eventb.core.identifier="mhr"/>
<org.eventb.core.parameter name="_S6aJc2NqEeqfwL_WG7Gltw" org.eventb.core.comment="Consumer" org.eventb.core.generated="false" org.eventb.core.identifier="c"/>
<org.eventb.core.guard name="_3Em1UGNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd4_r3" org.eventb.core.predicate="sp ∈ service_providers"/>
<org.eventb.core.guard name="_3Em1UWNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd5_r3" org.eventb.core.predicate="mhr ∈ my_health_report_DB"/>
<org.eventb.core.guard name="_3Em1UmNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd6_r3" org.eventb.core.predicate="c ∈ consumer"/>
<org.eventb.core.guard name="_S6aJdGNqEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd1_r3" org.eventb.core.predicate="c↦mhr ∈ my_MHR"/>
<org.eventb.core.guard name="_S6aJdWNqEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd2_r3" org.eventb.core.predicate="c↦sp ∈   consumer_sp"/>
<org.eventb.core.guard name="_swp5QGNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd3_r3" org.eventb.core.predicate="sp↦my_MHR(c) ∉ revoked_list_sp"/>
<org.eventb.core.guard name="_OKkrUGNsEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd7_r3" org.eventb.core.predicate="sp↦my_MHR(c) ∈ restricted_access_list_sp ∨ sp↦my_MHR(c) ∈ general_access_list_sp"/>
<org.eventb.core.action name="_wSVFtmNqEeqfwL_WG7Gltw" org.eventb.core.assignment="revoked_list_sp ≔ revoked_list_sp ∪ {sp↦my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act1_r3"/>
<org.eventb.core.action name="_wSVsyWNqEeqfwL_WG7Gltw" org.eventb.core.assignment="restricted_access_list_sp ≔ restricted_access_list_sp ∖ {sp↦my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act2_r3"/>
<org.eventb.core.action name="_wSVsymNqEeqfwL_WG7Gltw" org.eventb.core.assignment="general_access_list_sp ≔ general_access_list_sp ∖ {sp↦my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act3_r3"/>
</org.eventb.core.event>
<org.eventb.core.event name="_wSVFsGNqEeqfwL_WG7Gltw" org.eventb.core.comment="&#10;  &#9;Gives restricted access to a Service Provider&#10;&#10;  &#9;TODO: enforce&#10;  " org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="give_restricted_access_sp">
<org.eventb.core.parameter name="_wSVFsWNqEeqfwL_WG7Gltw" org.eventb.core.comment="Service Provider" org.eventb.core.generated="false" org.eventb.core.identifier="sp"/>
<org.eventb.core.parameter name="_wSVFsmNqEeqfwL_WG7Gltw" org.eventb.core.comment="My Health Record" org.eventb.core.generated="false" org.eventb.core.identifier="mhr"/>
<org.eventb.core.parameter name="_wSVFs2NqEeqfwL_WG7Gltw" org.eventb.core.comment="Consumer" org.eventb.core.generated="false" org.eventb.core.identifier="c"/>
<org.eventb.core.guard name="_5HWwMGNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd4_r3" org.eventb.core.predicate="sp ∈ service_providers"/>
<org.eventb.core.guard name="_5HWwMWNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd5_r3" org.eventb.core.predicate="mhr ∈ my_health_report_DB"/>
<org.eventb.core.guard name="_5HWwMmNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd6_r3" org.eventb.core.predicate="c ∈ consumer"/>
<org.eventb.core.guard name="_wSVFtGNqEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd1_r3" org.eventb.core.predicate="c↦mhr ∈ my_MHR"/>
<org.eventb.core.guard name="_wSVFtWNqEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd2_r3" org.eventb.core.predicate="c↦sp ∈ consumer_sp"/>
<org.eventb.core.guard name="_swp5QWNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd3_r3" org.eventb.core.predicate="sp↦my_MHR(c) ∈ revoked_list_sp ∨ sp↦my_MHR(c) ∈ general_access_list_sp"/>
<org.eventb.core.guard name="_czbyIGNsEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd7_r3" org.eventb.core.predicate="sp↦my_MHR(c) ∉ restricted_access_list_sp"/>
<org.eventb.core.action name="_wSVsyGNqEeqfwL_WG7Gltw" org.eventb.core.assignment="revoked_list_sp ≔ revoked_list_sp ∖ {sp↦my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act1_r3"/>
<org.eventb.core.action name="_jCqXsWNwEeqfwL_WG7Gltw" org.eventb.core.assignment="restricted_access_list_sp ≔ restricted_access_list_sp ∪ {sp↦my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act2_r3"/>
<org.eventb.core.action name="_jCqXsmNwEeqfwL_WG7Gltw" org.eventb.core.assignment="general_access_list_sp ≔ general_access_list_sp ∖ {sp↦my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act3_r3"/>
</org.eventb.core.event>
<org.eventb.core.event name="_wSVswmNqEeqfwL_WG7Gltw" org.eventb.core.comment="&#10;  &#9;Gives general access to a Service Provider&#10;&#10;  &#9;TODO: enforce&#10;  " org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="give_general_access_sp">
<org.eventb.core.parameter name="_wSVsw2NqEeqfwL_WG7Gltw" org.eventb.core.comment="Service Provider" org.eventb.core.generated="false" org.eventb.core.identifier="sp"/>
<org.eventb.core.parameter name="_wSVsxGNqEeqfwL_WG7Gltw" org.eventb.core.comment="My Health Record" org.eventb.core.generated="false" org.eventb.core.identifier="mhr"/>
<org.eventb.core.parameter name="_wSVsxWNqEeqfwL_WG7Gltw" org.eventb.core.comment="Consumer" org.eventb.core.generated="false" org.eventb.core.identifier="c"/>
<org.eventb.core.guard name="_5HXXQGNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd4_r3" org.eventb.core.predicate="sp ∈ service_providers"/>
<org.eventb.core.guard name="_5HXXQWNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd5_r3" org.eventb.core.predicate="mhr ∈ my_health_report_DB"/>
<org.eventb.core.guard name="_5HXXQmNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd6_r3" org.eventb.core.predicate="c ∈ consumer"/>
<org.eventb.core.guard name="_wSVsxmNqEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd1_r3" org.eventb.core.predicate="c↦mhr ∈ my_MHR"/>
<org.eventb.core.guard name="_wSVsx2NqEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd2_r3" org.eventb.core.predicate="c↦sp ∈   consumer_sp"/>
<org.eventb.core.guard name="_swqgUGNrEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd3_r3" org.eventb.core.predicate="sp↦my_MHR(c) ∈ revoked_list_sp ∨ sp↦my_MHR(c) ∈ restricted_access_list_sp"/>
<org.eventb.core.guard name="_czcZMGNsEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="grd7_r3" org.eventb.core.predicate="sp↦my_MHR(c) ∉ general_access_list_sp"/>
<org.eventb.core.action name="_jCqXsGNwEeqfwL_WG7Gltw" org.eventb.core.assignment="revoked_list_sp ≔ revoked_list_sp ∖ {sp↦my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act1_r3"/>
<org.eventb.core.action name="_lmveAGNwEeqfwL_WG7Gltw" org.eventb.core.assignment="restricted_access_list_sp ≔ restricted_access_list_sp ∖ {sp↦my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act2_r3"/>
<org.eventb.core.action name="_lmveAWNwEeqfwL_WG7Gltw" org.eventb.core.assignment="general_access_list_sp ≔ general_access_list_sp ∪ {sp↦my_MHR(c)}" org.eventb.core.generated="false" org.eventb.core.label="act3_r3"/>
</org.eventb.core.event>
<org.eventb.core.invariant name="_lmveAmNwEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="inv1_r3" org.eventb.core.predicate="general_access_list_sp ∈ service_providers ↔  my_health_report_DB"/>
<org.eventb.core.invariant name="_lmveA2NwEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="inv2_r3" org.eventb.core.predicate="restricted_access_list_sp ∈ service_providers ↔  my_health_report_DB"/>
<org.eventb.core.invariant name="_lmveBGNwEeqfwL_WG7Gltw" org.eventb.core.generated="false" org.eventb.core.label="inv3_r3" org.eventb.core.predicate="revoked_list_sp ∈ service_providers ↔  my_health_report_DB"/>
<org.eventb.core.invariant name="_lmveBWNwEeqfwL_WG7Gltw" org.eventb.core.comment="each Health Service Provider has only one access level to a My Health Record" org.eventb.core.generated="false" org.eventb.core.label="inv5_r3" org.eventb.core.predicate="partition(access_sp_mhr, general_access_list_sp, restricted_access_list_sp, revoked_list_sp)"/>
</org.eventb.core.machineFile>
